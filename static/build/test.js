(()=>{function t(t){return t&&t.__esModule?t.default:t}function e(t){if("string"!=typeof t)throw TypeError("Not a string")}function i(t){if("number"!=typeof t)throw TypeError("Not an integer or float")}function s(t,e){if(!(e instanceof Object))throw TypeError("Not a class");{const t=Object.getOwnPropertyDescriptors(e);if(void 0===t.prototype||void 0===t.prototype.writable||!0===t.prototype.writable)throw TypeError("Not a class")}if(t instanceof e==!1)throw TypeError("Not an instance of "+e.name)}function n(t){if(void 0===t.constructor||null===t.constructor||t.constructor!==Object)throw TypeError("Not an object")}function o(t){if("function"!=typeof t||"[object Function]"!==Object.prototype.toString.call(t))throw TypeError("Not a function")}function r(t){if(t.constructor!==Array)throw TypeError("Not an array")}class a{constructor(t,e,n,o,r){s(t,PIXI.Texture),i(e),i(n),i(o),i(r),this.sprite=new PIXI.Sprite(t),this.spriteFrameWidth=o,this.spriteFrameHeight=r,this.sprite_container=new PIXI.Container,this.sprite_container.addChild(this.sprite),this.sprite_container.x=e,this.sprite_container.y=n,this.original_tint=this.sprite.tint,this.frameMask=null,this.frames={},this.currentFrame=null,this.isFlippedHorizontally=!1,this.isFlippedVertically=!1,this.events={}}getLeftPosX(){return this.isFlippedHorizontally?this.sprite_container.x-this.spriteFrameWidth:this.sprite_container.x}getLeftPosY(){return this.isFlippedVertically?this.sprite_container.y-this.spriteFrameHeight:this.sprite_container.y}getRightPosX(){return this.isFlippedHorizontally?this.sprite_container.x:this.sprite_container.x+this.spriteFrameWidth}getRightPosY(){return this.isFlippedVertically?this.sprite_container.y:this.sprite_container.y+this.spriteFrameHeight}getCenterCoordinates(){return{x:this.getLeftPosX()+this.getHalfWidth(),y:this.getLeftPosY()+this.getHalfHeight()}}getSpriteFrameDimensions(){return{w:this.spriteFrameWidth,h:this.spriteFrameHeight}}getHalfWidth(){return.5*this.spriteFrameWidth}getHalfHeight(){return.5*this.spriteFrameHeight}getCurrentFrame(){return this.currentFrame}getSprite(){return this.sprite_container}__setFrameMask__(t,e,s,n){i(t),i(e),i(s),i(n),this.sprite_container.removeChild(this.frameMask);const o=new PIXI.Graphics;o.beginFill("black"),o.drawRect(t,e,s,n),o.endFill(),this.sprite.mask=o,this.sprite_container.addChild(o),this.frameMask=o,this.spriteFrameWidth=s,this.spriteFrameHeight=n}setPosition(t,e){i(t),i(e),this.sprite_container.x=t,this.sprite_container.y=e}addEvent(t,i){if(e(t),o(i),void 0===this.events[t])throw ReferenceError("Not a valid event");this.events[t].push(i)}addFrame(t,s,n,o,r){e(t),i(s),i(n),i(o),i(r),this.frames[t]={x:s,y:n,w:o,h:r}}addFrames(t){n(t);const e=Object.keys(t),i=e.length;if(i>0)for(let s=0;s<i;s++){const i=e[s],n=t[i];this.addFrame(i,n.x,n.y,n.w,n.h)}}switchFrame(t){const e=this.frames[t];this.sprite.x=-e.x,this.sprite.y=-e.y,this.__setFrameMask__(0,0,e.w,e.h),this.currentFrame=t;const i=this.events.onChangeFrame;if(null!=i){const t=i,e=t.length;for(let i=0;i<e;i++)t[i]({currentFrame:this.currentFrame})}}flipHorizontally(){this.isFlippedHorizontally?(this.sprite_container.scale.x=1,this.sprite_container.x-=this.spriteFrameWidth,this.isFlippedHorizontally=!1):(this.sprite_container.scale.x=-1,this.sprite_container.x+=this.spriteFrameWidth,this.isFlippedHorizontally=!0)}flipVertically(){this.isFlippedVertically?(this.sprite_container.scale.y=1,this.sprite_container.y-=this.spriteFrameHeight,this.isFlippedVertically=!1):(this.sprite_container.scale.y=-1,this.sprite_container.y+=this.spriteFrameHeight,this.isFlippedVertically=!0)}}class h{constructor(t,e,s,n,o){i(t),i(e),i(s),i(n),i(o),this.FILL=new PIXI.Graphics,this.FILL.beginFill(t),this.FILL.drawRect(0,0,n,o),this.FILL.endFill(),this.sprite=this.FILL,this.sprite.x=e,this.sprite.y=s,this.fillWidth=n,this.fillHeight=o}getLeftPosX(){return this.sprite.x}getLeftPosY(){return this.sprite.y}getRightPosX(){return this.sprite.x+this.fillWidth}getRightPosY(){return this.sprite.y+this.fillHeight}getCenterCoordinates(){return{x:this.getLeftPosX()+this.getHalfWidth(),y:this.getLeftPosY()+this.getHalfHeight()}}getFillDimensions(){return{w:this.fillWidth,h:this.fillHeight}}getHalfWidth(){return.5*this.fillWidth}getHalfHeight(){return.5*this.fillHeight}getSprite(){return this.sprite}setPosition(t,e){i(t),i(e),this.sprite.x=t,this.sprite.y=e}setFillDimensions(t,e){i(t),i(e),this.fillWidth=t,this.fillHeight=e}setAlpha(t){if(i(t),t<0||t>1)throw Error("Alpha must be a value between 0 and 1.");this.FILL.alpha=t}}class l{constructor(t){s(t,PIXI.Texture),this.texture=t,this.icon=new PIXI.Sprite(t)}getIcon(){return this.icon}}const d=window.location.href,c=`${d.substring(0,d.indexOf("/static/"))}/static`,g=`${c}/js`,u=`${c}/assets`,p=`${u}/sounds`;function m(t){s(t,PIXI.Container),void 0!==window.HOTBAR&&null!==window.HOTBAR&&(window.HOTBAR.getSelItem()instanceof w?t.cursor=`url(${u}/guns/crosshair.png), auto`:t.cursor="auto")}class f extends l{constructor(t){super(t)}createCopy(t,e,n,o,r){s(t,PIXI.Texture),i(e),i(n),i(o),i(r);const a=new PIXI.Sprite(this.texture);return a.x=e,a.y=n,a.width=o,a.height=r,a}}class w extends f{constructor(t){super(t)}getAmmoLoaded(){return this.ammoLoaded<0?0:this.ammoLoaded}getMaxAmmo(){return this.maxAmmo}getAmmoLeft(){return this.ammoLeft}getClipCapacity(){return this.clipCapacity}playGunFireSound(){new Audio(this.gunFireSoundFile).play()}playReloadSound(){const t=new Audio(this.reloadSoundFile);return t.play(),t}getDamage(){return this.damage}fire(){"semi-auto"===this.mode&&(this.ammoLoaded-=1),this.ammoLoaded>-1&&(this.playGunFireSound(),I(this)),0===this.ammoLoaded&&this.ammoLeft>0&&this.reload()}reload(){this.playReloadSound(),setTimeout((()=>{if(this.ammoLoaded<=0)this.ammoLeft>=12?(this.ammoLeft-=this.clipCapacity,this.ammoLoaded=this.clipCapacity):this.ammoLeft<12&&(this.ammoLoaded=this.ammoLeft,this.ammoLeft-=this.ammoLeft);else if(this.ammoLoaded>0){const t=this.clipCapacity-this.ammoLoaded;this.ammoLeft>=t?(this.ammoLoaded+=t,this.ammoLeft-=t):this.ammoLeft<t&&(this.ammoLoaded+=this.ammoLeft,this.ammoLeft-=this.ammoLeft)}I(this)}),this.reloadDuration)}addMaxAmmo(t){this.ammoLeft=t,I(this)}setDamage(t){this.damage=t}increaseDamage(t){this.damage+=t}increaseClipCapacity(t){this.clipCapacity+=t}increaseMaxAmmo(t){this.maxAmmo+=t}}class y extends w{constructor(t){super(t),this.gunFireSoundFile=`${p}/pistol.mp3`,this.reloadSoundFile=`${p}/pistol_reload.mp3`,this.reloadDuration=1e3,this.mode="semi-auto",this.clipCapacity=12,this.ammoLoaded=this.clipCapacity,this.ammoLeft=60,this.maxAmmo=this.ammoLeft,this.damage=25}loadNorth(){const t=this.createCopy(this.texture,25,18,25,25);return t.scale.y=-1,t.rotation=4.6,t}loadSouth(){const t=this.createCopy(this.texture,0,20,25,25);return t.scale.y=-1,t.rotation=1.5,t}loadWest(){const t=this.createCopy(this.texture,18,8,25,25);return t.scale.x=-1,t}loadEast(){return this.createCopy(this.texture,5,8,25,25)}}const S={fontSize:20,fill:16777215},_=new PIXI.Text("Health: 100",S);function P(t){i(t),_.text="Health: "+t}_.x=20,_.y=10;const v=new PIXI.Text("Points: 1000",S);function b(t){i(t),v.text="Points: "+t}v.x=300,v.y=10;const x=new PIXI.Text("Ammo: n/a",S);function I(t){s(t,w),x.text=`Ammo: ${t.getAmmoLoaded()}/${t.getAmmoLeft()}`}function E(){x.text=""}x.x=160,x.y=10;const C=document.getElementById("death-screen"),F=document.getElementById("time-survived");document.getElementById("points-earned");function A(){window.GAME_PAUSED=!0;const t=new Date-window.timeGameStarted,e=Math.round(t/36e5),i=Math.round(t/6e4),s=Math.round(t/1e3);let n=0,o=0,r=0;e>.1&&(n=e),i>.1&&(o=i),s>.1&&(r=s),F.innerText=`${n}h:${o}m:${r}s`;const a=new XMLHttpRequest;a.open("POST","/store_score"),a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify({millisecondsSurvived:t,pointsEarned:0})),C.classList.remove("hide")}C.addEventListener("click",(t=>{const e=t.target;if("BUTTON"===e.tagName){"exit"===e.getAttribute("data-action")&&window.location.assign("/")}}));class L extends a{constructor(t,e,i,s,n){super(t,e,i,s,n)}}class D extends L{constructor(t,e,i,s,n){super(t,e,i,s,n),this.detours={top:[],bottom:[],left:[],right:[]}}checkIfLeftEdgeCollisionOccurred(t){return s(t,a),!(t.getRightPosY()<this.getLeftPosY())&&(!(t.getLeftPosY()>this.getRightPosY())&&(!(t.getRightPosX()<this.getLeftPosX())&&!(t.getLeftPosX()>this.getLeftPosX())))}checkIfRightEdgeCollisionOccurred(t){return s(t,a),!(t.getRightPosY()<this.getLeftPosY())&&(!(t.getLeftPosY()>this.getRightPosY())&&(!(t.getLeftPosX()>this.getRightPosX())&&!(t.getRightPosX()<this.getRightPosX())))}checkIfTopEdgeCollisionOccurred(t){return s(t,a),!(t.getRightPosX()<this.getLeftPosX())&&(!(t.getLeftPosX()>this.getRightPosX())&&(!(t.getRightPosY()<this.getLeftPosY())&&!(t.getLeftPosY()>this.getLeftPosY())))}checkIfBottomEdgeCollisionOccurred(t){return s(t,a),!(t.getRightPosX()<this.getLeftPosX())&&(!(t.getLeftPosX()>this.getRightPosX())&&(!(t.getLeftPosY()>this.getRightPosY())&&!(t.getRightPosY()<this.getRightPosY())))}getDetours(t){return e(t),this.detours[t]}__addDetour__(t,s){r(t),e(s);const o=t.length;for(let e=0;e<o;e++){const s=t[e];if(n(s),void 0===s.x||void 0===s.y)throw SyntaxError(`Element ${e} is not a valid point object. It must have an x and a y property`);i(s.x),i(s.y)}this.detours[s].push(t)}addBottomEdgeDetour(t){this.__addDetour__(t,"bottom")}addTopEdgeDetour(t){this.__addDetour__(t,"top")}addLeftEdgeDetour(t){this.__addDetour__(t,"left")}addRightEdgeDetour(t){this.__addDetour__(t,"right")}}class R extends L{constructor(t,e,i,s,n){super(t,e,i,s,n)}}class T extends D{constructor(t,e,i,s,n){super(t,e,i,s,n),this.boundaryLeftX=0,this.boundaryLeftY=0,this.boundaryRightX=0,this.boundaryRightY=0}modifyCollisionBoundary(t,e,s,n){null!=t&&(i(t),this.boundaryLeftX=t),null!=e&&(i(e),this.boundaryLeftY=e),null!=s&&(i(s),this.boundaryRightX=s),null!=n&&(i(n),this.boundaryRightY=n)}getLeftPosX(){return this.isFlippedHorizontally?this.sprite_container.x+this.boundaryLeftX-this.spriteFrameWidth:this.sprite_container.x+this.boundaryLeftX}getLeftPosY(){return this.isFlippedVertically?this.sprite_container.y+this.boundaryLeftY-this.spriteFrameHeight:this.sprite_container.y+this.boundaryLeftY}getRightPosX(){return this.isFlippedHorizontally?this.sprite_container.x+this.boundaryLeftX:this.sprite_container.x+(this.spriteFrameWidth+this.boundaryRightX)}getRightPosY(){return this.isFlippedVertically?this.sprite_container.y+this.boundaryLeftY:this.sprite_container.y+(this.spriteFrameHeight+this.boundaryRightY)}}class H extends h{constructor(t,e,i,s,n){super(t,e,i,s,n),this.detours={top:[],bottom:[],left:[],right:[]}}checkIfLeftEdgeCollisionOccurred(t){return s(t,a),!(t.getRightPosY()<this.getLeftPosY())&&(!(t.getLeftPosY()>this.getRightPosY())&&(!(t.getRightPosX()<this.getLeftPosX())&&!(t.getLeftPosX()>this.getLeftPosX())))}checkIfRightEdgeCollisionOccurred(t){return s(t,a),!(t.getRightPosY()<this.getLeftPosY())&&(!(t.getLeftPosY()>this.getRightPosY())&&(!(t.getLeftPosX()>this.getRightPosX())&&!(t.getRightPosX()<this.getRightPosX())))}checkIfTopEdgeCollisionOccurred(t){return s(t,a),!(t.getRightPosX()<this.getLeftPosX())&&(!(t.getLeftPosX()>this.getRightPosX())&&(!(t.getRightPosY()<this.getLeftPosY())&&!(t.getLeftPosY()>this.getLeftPosY())))}checkIfBottomEdgeCollisionOccurred(t){return s(t,a),!(t.getRightPosX()<this.getLeftPosX())&&(!(t.getLeftPosX()>this.getRightPosX())&&(!(t.getLeftPosY()>this.getRightPosY())&&!(t.getRightPosY()<this.getRightPosY())))}getDetours(t){return e(t),this.detours[t]}__addDetour__(t,s){r(t),e(s);const o=t.length;for(let e=0;e<o;e++){const s=t[e];if(n(s),void 0===s.x||void 0===s.y)throw SyntaxError(`Element ${e} is not a valid point object. It must have an x and a y property`);i(s.x),i(s.y)}this.detours[s].push(t)}addBottomEdgeDetour(t){this.__addDetour__(t,"bottom")}addTopEdgeDetour(t){this.__addDetour__(t,"top")}addLeftEdgeDetour(t){this.__addDetour__(t,"left")}addRightEdgeDetour(t){this.__addDetour__(t,"right")}}class O extends h{constructor(t,e,i,s,n){super(t,e,i,s,n)}}class X extends H{constructor(t,e,i,s,n){super(t,e,i,s,n),this.boundaryLeftX=0,this.boundaryLeftY=0,this.boundaryRightX=0,this.boundaryRightY=0}modifyCollisionBoundary(t,e,s,n){null!=t&&(i(t),this.boundaryLeftX=t),null!=e&&(i(e),this.boundaryLeftY=e),null!=s&&(i(s),this.boundaryRightX=s),null!=n&&(i(n),this.boundaryRightY=n)}getLeftPosX(){return this.sprite.x+this.boundaryLeftX}getLeftPosY(){return this.sprite.y+this.boundaryLeftY}getRightPosX(){return this.sprite.x+(this.fillWidth+this.boundaryRightX)}getRightPosY(){return this.sprite.y+(this.fillHeight+this.boundaryRightY)}}class Y extends a{constructor(t,e,i,s,n){super(t,e,i,s,n),this.movementOffset=5,this.events={move:[],onChangeFrame:[]},this.itemInstance=null,this.equippedItem=null,this.addEvent("onChangeFrame",(()=>{null!==this.itemInstance&&(this.sprite_container.removeChild(this.equippedItem),this.itemInstance instanceof f&&this.__renderWeapon__(this.itemInstance,this.currentFrame))}))}__renderWeapon__(t,i){if(s(t,f),e(i),"n"===i||"nl"===i||"nr"===i)return this.equippedItem=t.loadNorth(),void this.sprite_container.addChildAt(this.equippedItem,0);"s"===i||"sl"===i||"sr"===i?this.equippedItem=t.loadSouth():"w"===i||"wl"===i||"wr"===i?this.equippedItem=t.loadWest():"e"!==i&&"el"!==i&&"er"!==i||(this.equippedItem=t.loadEast()),this.sprite_container.addChild(this.equippedItem)}getSpeed(){return this.movementOffset}equip(t){s(t,l),this.itemInstance=t,t instanceof f&&this.__renderWeapon__(t,this.currentFrame)}unequip(){this.sprite_container.removeChild(this.equippedItem),this.itemInstance=null,this.equippedItem=null}showDamage(){this.sprite.tint=16711680}hideDamage(){this.sprite.tint=this.original_tint}setSpeed(t){i(t),this.movementOffset=t}moveSprite(t,e){i(t),i(e),this.sprite_container.x+=t,this.sprite_container.y+=e;const s=this.events.move;if(null!=s){const t=s,e=t.length;for(let i=0;i<e;i++)t[i]({currentFrame:this.currentFrame})}}moveSpriteNorth(){this.moveSprite(0,-this.movementOffset)}moveSpriteNorthWest(){this.moveSprite(-this.movementOffset,-this.movementOffset)}moveSpriteNorthEast(){this.moveSprite(this.movementOffset,-this.movementOffset)}moveSpriteWest(){this.moveSprite(-this.movementOffset,0)}moveSpriteEast(){this.moveSprite(this.movementOffset,0)}moveSpriteSouth(){this.moveSprite(0,this.movementOffset)}moveSpriteSouthWest(){this.moveSprite(-this.movementOffset,this.movementOffset)}moveSpriteSouthEast(){this.moveSprite(this.movementOffset,this.movementOffset)}}class W extends Y{constructor(t,e,i,s,n){super(t,e,i,s,n),this.health=100,this.invincibility=!1,this.currentPoints=1e3;let o=null;this.addEvent("move",(t=>{clearTimeout(o),o=setTimeout((()=>{this.rotateToMouse()}),100),(new Date).getMilliseconds()%2==0&&("s"===t.currentFrame||"sr"===t.currentFrame?this.switchFrame("sl"):"sl"===t.currentFrame?this.switchFrame("sr"):"e"===t.currentFrame||"er"===t.currentFrame?this.switchFrame("el"):"w"===t.currentFrame||"wr"===t.currentFrame?this.switchFrame("wl"):"wl"===t.currentFrame?this.switchFrame("wr"):"e"===t.currentFrame||"er"===t.currentFrame?this.switchFrame("el"):"el"===t.currentFrame?this.switchFrame("er"):"n"===t.currentFrame||"nr"===t.currentFrame?this.switchFrame("nl"):"nl"===t.currentFrame&&this.switchFrame("nr"))}))}isInvincible(){return this.invincibility}getHealth(){return this.health}rotateToMouse(){const t=this.getCenterCoordinates();let e=this.sprite_container.parent,i=t.x+e.x,s=t.y+e.y;for(;null!==e.parent;)e=e.parent,i+=e.x,s+=e.y;const n=window.mouseX-i,o=window.mouseY-s,r=Math.round(180*Math.atan2(o,n)/Math.PI);r>=-145&&r<=-45?this.switchFrame("n"):r>=-180&&r<-145||r<=180&&r>145?this.switchFrame("w"):r<=145&&r>45?this.switchFrame("s"):(r>=0&&r<=45||r<0&&r>-45)&&this.switchFrame("e")}activateInvincibility(){this.invincibility=!0,setTimeout((()=>{this.invincibility=!1,this.hideDamage()}),1e3)}setHealth(t){i(t),this.health=t}increaseHealth(t){i(t),this.health+=t,this.health>100&&(this.health=100),P(this.health)}decreaseHealth(t){i(t),this.health-=t,this.showDamage(),P(this.health),this.health<0&&(this.health=0),0===this.health&&(this.sprite.parent.removeChild(this.sprite),A())}}class B extends Y{constructor(t,e,i,s,n){super(t,e,i,s,n),this.navigationMode=0,this.objectCollidedWith=null,this.edgeCollidedWith=null,this.detourChosen=null,this.detourPointIndex=0,this.isDead=!1,k.push(this),this.sprite_container.interactive=!0,this.sprite_container.on("mousedown",(t=>{if(t.stopPropagation(),void 0!==window.HOTBAR&&null!==window.HOTBAR){const t=window.HOTBAR.getSelItem();t instanceof w&&(t.fire(),t.ammoLoaded>0&&(this.decreaseHealth(t.getDamage()),this.showDamage(),setTimeout((()=>{this.hideDamage()}),500)))}})),this.sprite_container.on("mousemove",(()=>{m(this.sprite_container)}))}__getMoveDirectionFromAngle__(t){return i(t),t>=-120&&t<=-60?"n":t>=-150&&t<=-120?"nw":t>=-180&&t<=-150||t<=180&&t>=150?"w":t<=150&&t>=120?"sw":t<=120&&t>=60?"s":t<=60&&t>=30?"se":t<=30&&t>=0||t<=0&&t>=-30?"e":t<=-30&&t>=-60?"ne":void 0}__getEnemyXandYDistanceFromPlayer__(t){s(t,W);const e=t.getSprite(),i=t.getCenterCoordinates(),n=this.getCenterCoordinates();return{dx:i.x+e.x-(n.x+this.sprite_container.x),dy:i.y+e.y-(n.y+this.sprite_container.y)}}__getAngleToPlayer__(t){const e=this.__getEnemyXandYDistanceFromPlayer__(t);return Math.round(180*Math.atan2(e.dy,e.dx)/Math.PI)}getClosestDetour(t,i){if(t instanceof D==!1&&t instanceof H==!1)return;if(e(i),"bottom"!==(i=i.toLowerCase())&&"top"!==i&&"left"!==i&&"right"!==i)throw ReferenceError("Edge can only be one of the following: top, bottom, left, right");const s=t.getDetours(i),n=this.getCenterCoordinates();let o=null,r=null;const a=s.length;for(let t=0;t<a;t++){const e=s[t][0],i=Math.round(Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)));(null===o||i<r)&&(o=s[t],r=i)}return null!==o?[...o]:null}__switchFrameToAngle__(t){t>=-145&&t<=-45?this.switchFrame("n"):t>=-180&&t<-145||t<=180&&t>145?this.switchFrame("w"):t<=145&&t>45?this.switchFrame("s"):(t>=0&&t<=45||t<0&&t>-45)&&this.switchFrame("e")}rotateToPlayer(t){const e=this.__getAngleToPlayer__(t);this.__switchFrameToAngle__(e)}stopFollowingPlayerAndMoveAroundObject(t){if(n(t),t.object instanceof D==!1&&t.object instanceof H==!1)throw TypeError("Object must be an obstacle.");if(void 0===t.edge)throw SyntaxError("Collision data is missing edge information.");e(t.edge),this.navigationMode=1,this.objectCollidedWith=t.object,this.edgeCollidedWith=t.edge}stopFollowingDetourAndChasePlayerAgain(t){s(t,W),this.detourChosen=null,this.detourPointIndex=0,this.navigationMode=0,this.objectCollidedWith=null,this.edgeCollidedWith=null,this.__switchFrameToAngle__(this.__getAngleToPlayer__(t))}moveToPlayer(t){const e=this.__getAngleToPlayer__(t);if(0===this.navigationMode){const i=this.__getMoveDirectionFromAngle__(e),s=z(this),n=q(this);if("e"===i||"ne"===i||"se"===i){const t=$(this);switch(i){case"e":!1===t.status?this.moveSpriteEast():!0===t.status&&this.stopFollowingPlayerAndMoveAroundObject(t);break;case"ne":!1===s.status&&!1===t.status&&this.moveSpriteNorthEast();break;case"se":!1===n.status&&!1===t.status&&this.moveSpriteSouthEast()}}else if("w"===i||"nw"===i||"sw"===i){const t=G(this);switch(i){case"w":!1===t.status?this.moveSpriteWest():!0===t.status&&this.stopFollowingPlayerAndMoveAroundObject(t);break;case"nw":!1===s.status&&!1===t.status&&this.moveSpriteNorthWest();break;case"sw":!1===n.status&&!1===t.status&&this.moveSpriteSouthWest()}}else"n"===i?!1===s.status?this.moveSpriteNorth():!0===s.status&&this.stopFollowingPlayerAndMoveAroundObject(s):"s"===i&&(!1===n.status?this.moveSpriteSouth():!0===n.status&&this.stopFollowingPlayerAndMoveAroundObject(n));if(!1===t.isInvincible()&&t.getHealth()>0&&this.sprite.alpha>=1){const e=this.__getEnemyXandYDistanceFromPlayer__(t);Math.sqrt(Math.pow(e.dx,2)+Math.pow(e.dy,2))<=40&&this.__damagePlayer___(t)}}else if(1===this.navigationMode){const e=this.__getEnemyXandYDistanceFromPlayer__(t),i=Math.round(Math.sqrt(Math.pow(e.dx,2)+Math.pow(e.dy,2)));if(null===this.detourChosen&&null!==this.edgeCollidedWith)this.detourChosen=this.getClosestDetour(this.objectCollidedWith,this.edgeCollidedWith);else if(null!==this.detourChosen&&this.detourChosen.constructor===Array){if(this.detourChosen.length>0){const e=this.detourChosen[this.detourPointIndex],s=this.getCenterCoordinates();if(!(Math.round(Math.sqrt(Math.pow(s.x-e.x,2)+Math.pow(s.y-e.y,2)))<i))return void this.stopFollowingDetourAndChasePlayerAgain(t);this.moveToDetourPoint(e),Math.round(s.x)===e.x&&Math.round(s.y)===e.y&&(this.detourPointIndex+=1),this.detourPointIndex===this.detourChosen.length&&this.stopFollowingDetourAndChasePlayerAgain(t)}}}}moveToDetourPoint(t){if(n(t),void 0===t.x||void 0===t.y)throw SyntaxError("Point must be an object with x and y as properties.");i(t.x),i(t.y);const e=this.getCenterCoordinates(),s=Math.round(180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI);this.__switchFrameToAngle__(s);switch(this.__getMoveDirectionFromAngle__(s)){case"n":this.moveSpriteNorth();break;case"nw":this.moveSpriteNorthWest();break;case"w":this.moveSpriteWest();break;case"sw":this.moveSpriteSouthWest();break;case"s":this.moveSpriteSouth();break;case"se":this.moveSpriteSouthEast();break;case"e":this.moveSpriteEast();break;case"ne":this.moveSpriteNorthEast()}}decreaseHealth(t){i(t),this.health-=t}removeSelf(){return this.health<=0&&(new Audio(this.deathSoundFile).play(),this.sprite_container.parent.removeChild(this.sprite_container),k.splice(k.indexOf(this),1),!0)}}class N extends B{constructor(t,e,i,s,n){super(t,e,i,s,n),this.health=100,this.damage=20,this.deathSoundFile=`${p}/zombie-death.mp3`,this.setSpeed(.5)}__damagePlayer___(t){s(t,W),t.decreaseHealth(this.damage),t.activateInvincibility()}}const M=[],k=[];function j(t,e){s(t,Y);const i=M.length;if(i>0){const s=t.getSpeed(),n=t.getLeftPosX()-s,o=t.getLeftPosY()-s,r=t.getRightPosX()+s,a=t.getRightPosY()+s;for(let t=0;t<i;t++){const i=M[t],h=i.getLeftPosX(),l=i.getLeftPosY(),d=i.getRightPosX(),c=i.getRightPosY();if("top"===e){const t=a<l,e=n>=h&&r<=d,g=n<h,u=r>d,p=n>=h&&n<=d,m=r>=h&&r<=d,f=r-s;if(a>c&&a>l)continue;if(f<h&&o<c)continue;if(f<h&&a>l)continue;if(!1===t){if(e)return{status:!0,object:i,edge:"top"};if(g&&m)return{status:!0,object:i,edge:"top"};if(u&&p)return{status:!0,object:i,edge:"top"}}}else if("left"===e){const t=r<h,e=o>=l&&a<=c,g=o<l,u=a>c,p=o>=l&&o<=c,m=a>=l&&a<=c,f=a-s;if(r>h&&r>d)continue;if(f<l&&n>h)continue;if(f>c&&n>h)continue;if(!1===t){if(e)return{status:!0,object:i,edge:"left"};if(g&&m)return{status:!0,object:i,edge:"left"};if(u&&p)return{status:!0,object:i,edge:"left"}}}else if("right"===e){const t=n>d,e=o>=l&&a<=c,g=o<l,u=a>c,p=o>=l&&o<=c,m=a>=l&&a<=c,f=a-s;if(n<h&&n<d)continue;if(f<l&&r<d)continue;if(f>c&&r<d)continue;if(!1===t){if(e)return{status:!0,object:i,edge:"right"};if(g&&m)return{status:!0,object:i,edge:"right"};if(u&&p)return{status:!0,object:i,edge:"right"}}}else if("bottom"===e){const t=o>c,e=n>=h&&r<=d,g=n<h,u=r>d,p=n>=h&&n<=d,m=r>=h&&r<=d,f=n+s;if(o<c&&o<l)continue;if(f>d&&o<c)continue;if(f>d&&a>l)continue;if(!1===t){if(e)return{status:!0,object:i,edge:"bottom"};if(g&&m)return{status:!0,object:i,edge:"bottom"};if(u&&p)return{status:!0,object:i,edge:"bottom"}}}}}return{status:!1,object:void 0,edge:void 0}}function $(t){return j(t,"left")}function G(t){return j(t,"right")}function q(t){return j(t,"top")}function z(t){return j(t,"bottom")}const U=[];class V extends L{constructor(t,e,i,s,n){super(t,e,i,s,n),this.areaOfEffect=20}playerIsNearInteractable(t){s(t,W);const e=t.getCenterCoordinates(),i=e.x>this.getLeftPosX()-this.areaOfEffect&&e.x<this.getRightPosX()+this.areaOfEffect,n=e.y>this.getLeftPosY()-this.areaOfEffect&&e.y<this.getRightPosY()+this.areaOfEffect;return!(!i||!n)}setAreaOfEffect(t){i(t),this.areaOfEffect=t}}class J extends V{constructor(t,e,i,s,n){super(t,e,i,s,n),this.pointCost=500}resupply(t){s(t,w),t.addMaxAmmo(t.getMaxAmmo()),t.playReloadSound()}}class Q extends V{constructor(t,e,i,s,n){super(t,e,i,s,n),this.pointCost=1e3}upgradeGun(t,e){s(t,w),e?(t.increaseMaxAmmo(10),t.increaseClipCapacity(3)):t.increaseDamage(10)}}const K=[];class Z extends R{constructor(t,e,i,n,o,r){s(t,et),super(e,i,n,o,r),this.origin=t,this.destination=null,this.dest_X=null,this.dest_Y=null}playerIsInsidePortal(t){s(t,W);const e=t.getCenterCoordinates();return e.x>this.getLeftPosX()&&e.x<this.getRightPosX()&&e.y>this.getLeftPosY()&&e.y<this.getRightPosY()}setDestination(t,e,n){s(t,et),i(e),i(n),this.destination=t,this.dest_X=e,this.dest_Y=n}teleport(t){s(t,W);const e=this.origin.area.parent;this.origin.unload(),e.removeChild(this.origin.area),e.addChild(this.destination.load()),this.destination.addDynamicSprite(t,"player",this.dest_X,this.dest_Y)}}class tt extends O{constructor(t,e,i,n,o,r){s(t,et),super(e,i,n,o,r),this.origin=t,this.destination=null,this.dest_X=null,this.dest_Y=null}playerIsInsidePortal(t){s(t,W);const e=t.getCenterCoordinates();return e.x>this.getLeftPosX()&&e.x<this.getRightPosX()&&e.y>this.getLeftPosY()&&e.y<this.getRightPosY()}setDestination(t,e,n){s(t,et),i(e),i(n),this.destination=t,this.dest_X=e,this.dest_Y=n}teleport(t){s(t,W);const e=this.origin.area.parent;this.origin.unload(),e.removeChild(this.origin.area),e.addChild(this.destination.load()),this.destination.addDynamicSprite(t,"player",this.dest_X,this.dest_Y)}}class et{constructor(t,e){this.area=new PIXI.Container,this.width=t,this.height=e;const i=new PIXI.Graphics;i.beginFill(16777215),i.drawRect(0,0,t,e),i.endFill(),this.area.addChild(i),this.staticSprites={},this.dynamicSprites={},this.STATIC_SPRITES_CONTAINER=new PIXI.Container,this.DYNAMIC_SPRITES_CONTAINER=new PIXI.Container,this.OBSTACLES=[],this.PORTALS=[],this.INTERACTABLES=[],this.ENEMY_SPAWN_POINTS=[],this.COLORED_COORDINATES=[],this.area.interactive=!0,this.mousedownEvent=function(){if(!1===window.GAME_PAUSED&&void 0!==window.HOTBAR&&null!==window.HOTBAR){const t=window.HOTBAR.getSelItem();t instanceof w&&t.fire()}},this.mousemoveEvent=function(){m(this)},this.infinite_loop=new PIXI.Ticker,this.infinite_loop.add((()=>{this.sortSpriteOrder()}))}getLeftPosX(){return this.area.x}getLeftPosY(){return this.area.y}getRightPosX(){return this.area.x+this.area.width}getRightPosY(){return this.area.y+this.area.height}getWidth(){return this.width}getHeight(){return this.height}getHalfWidth(){return.5*this.width}getHalfHeight(){return.5*this.height}getEnemySpawnPoints(){return this.ENEMY_SPAWN_POINTS}load(){window.GAME_PAUSED=!1,this.area.addChild(this.STATIC_SPRITES_CONTAINER,this.DYNAMIC_SPRITES_CONTAINER);const t=this.COLORED_COORDINATES.length;for(let e=0;e<t;e++)this.area.addChild(this.COLORED_COORDINATES[e]);const e=this.OBSTACLES.length;for(let t=0;t<e;t++)M.push(this.OBSTACLES[t]);const i=this.PORTALS.length;for(let t=0;t<i;t++)K.push(this.PORTALS[t]);const s=this.INTERACTABLES.length;for(let t=0;t<s;t++)U.push(this.INTERACTABLES[t]);return this.infinite_loop.start(),this.area.on("mousedown",this.mousedownEvent),this.area.on("mousemove",this.mousemoveEvent),window.playableAreaExists=!0,this.area}unload(){window.GAME_PAUSED=!0,this.area.removeChild(this.STATIC_SPRITES_CONTAINER),this.area.removeChild(this.DYNAMIC_SPRITES_CONTAINER);const t=Object.keys(this.dynamicSprites),e=t.length;for(let i=0;i<e;i++){const e=t[i],s=this.dynamicSprites[e];s instanceof Y&&(this.DYNAMIC_SPRITES_CONTAINER.removeChild(s.getSprite()),delete this.dynamicSprites[e])}M.splice(0,M.length),K.splice(0,K.length),U.splice(0,U.length),this.infinite_loop.stop(),this.area.off("mousedown",this.mousedownEvent),this.area.off("mousemove",this.mousemoveEvent),this.area.parent.removeChild(this.area),window.playableAreaExists=!1}setPosition(t,e){i(t),i(e),this.area.x=t,this.area.y=e}addEvent(t,i){e(t),o(i),this.area.on(t,i)}addStaticSprite(t,s,n,o){if(t instanceof a==!1&&t instanceof h==!1)throw ReferenceError(`Not an instance of ${a.name} or ${h.name}`);if(e(s),i(n),i(o),void 0!==this.staticSprites[s])throw ReferenceError(`A sprite with the id '${s}' already exists`);this.STATIC_SPRITES_CONTAINER.addChild(t.getSprite()),this.staticSprites[s]=t,t instanceof D||t instanceof H?this.OBSTACLES.push(t):t instanceof Z||t instanceof tt?this.PORTALS.push(t):t instanceof V&&this.INTERACTABLES.push(t),t.setPosition(n,o)}addDynamicSprite(t,s,n,o){if(t instanceof a==!1&&t instanceof h==!1)throw ReferenceError(`Not an instance of ${a.name} or ${h.name}`);if(e(s),i(n),i(o),void 0!==this.dynamicSprites[s])throw ReferenceError(`A sprite with the id '${s}' already exists`);this.DYNAMIC_SPRITES_CONTAINER.addChild(t.getSprite()),this.dynamicSprites[s]=t,(t instanceof D||t instanceof H)&&this.OBSTACLES.push(t),t.setPosition(n,o)}addEnemySpawnPoint(t,e,s){i(t),i(e),this.ENEMY_SPAWN_POINTS.push({x:t,y:e}),"number"==typeof s&&this.colorCoordinate(s,t,e,5,5)}sortSpriteOrder(){const t=Object.values(this.dynamicSprites);let e=t.length;if(e>0){for(let i=0;i<e;i++){null===t[i].getSprite().parent&&(t.splice(i,1),e=t.length,delete this.dynamicSprites[Object.keys(this.dynamicSprites)[i]])}let i=[];for(let s=0;s<e;s++){const e=t[s];i.push(e.getRightPosY())}i=i.sort();for(let s=0;s<e;s++){const n=i[s];for(let i=0;i<e;i++){const e=t[i];e.getRightPosY()===n&&this.DYNAMIC_SPRITES_CONTAINER.setChildIndex(e.getSprite(),s)}}}}colorCoordinate(t,e,s,n,o){i(t),i(e),i(s),i(n),i(o),n>1&&(e-=.5*n),o>1&&(s-=.5*o);const r=new PIXI.Graphics;r.beginFill(t),r.drawRect(e,s,n,o),r.endFill(),this.COLORED_COORDINATES.push(r)}__addDetour__(t,i,s,n){if(t instanceof D==!1&&t instanceof H==!1)throw TypeError("Object must be an obstacle.");switch(e(i),i){case"bottom":t.addBottomEdgeDetour(s);break;case"top":t.addTopEdgeDetour(s);break;case"left":t.addLeftEdgeDetour(s);break;case"right":t.addRightEdgeDetour(s)}if("number"==typeof n){const t=s.length;for(let e=0;e<t;e++){const t=s[e];this.colorCoordinate(n,t.x,t.y,5,5)}}}addBottomEdgeDetour(t,e,i){this.__addDetour__(t,"bottom",e,i)}addTopEdgeDetour(t,e,i){this.__addDetour__(t,"top",e,i)}addLeftEdgeDetour(t,e,i){this.__addDetour__(t,"left",e,i)}addRightEdgeDetour(t,e,i){this.__addDetour__(t,"right",e,i)}bindPlayableAreaToPortal(t,i,s,n){e(t);const o=this.staticSprites[t];if(void 0===o)throw Error("A portal with that ID does not exist.");o.setDestination(i,s,n)}}function it(t){if(e(t),"/"!==t[0])throw ReferenceError("Paths must start with /");return PIXI.Texture.from(`${g}${t}`)}function st(t){if(e(t),"/"!==t[0])throw ReferenceError("Paths must start with /");return PIXI.Texture.from(`${u}${t}`)}const nt=function(){const t=new et(512,400);t.addEnemySpawnPoint(30,250),t.addEnemySpawnPoint(t.getWidth()-30,250),t.addEnemySpawnPoint(255,t.getHeight()-30);const e=new O(7559240,0,0,512,400);t.addStaticSprite(e,"floor",0,0);const i=new X(0,0,0,t.getWidth(),10);i.modifyCollisionBoundary(null,null,null,-i.getHalfHeight()),t.addStaticSprite(i,"barrier1",0,-i.getFillDimensions().h);const s=new X(0,0,0,t.getWidth(),10);t.addStaticSprite(s,"barrier2",0,t.getHeight());const n=new X(0,0,0,10,t.getHeight());n.modifyCollisionBoundary(null,null,-3,null),t.addStaticSprite(n,"barrier3",-n.getFillDimensions().w,0);const o=new X(0,0,0,10,t.getHeight());o.modifyCollisionBoundary(-3,null,null,null),t.addStaticSprite(o,"barrier4",t.getWidth(),0);const r=new T(it("/map/foyer/assets/Door1.png"),0,0,96,48);t.addStaticSprite(r,"double_door",t.getHalfWidth()-r.getHalfWidth(),-(r.getSpriteFrameDimensions().h+1));const a=new tt(t,16711680,0,0,r.getSpriteFrameDimensions().w,40);a.setAlpha(0),t.addStaticSprite(a,"elevator",t.getHalfWidth()-r.getHalfWidth(),0);const h=new R(it("/map/foyer/assets/window.png"),0,0,105,75);t.addStaticSprite(h,"window",50,-(h.getSpriteFrameDimensions().h-5));const l=new Z(t,it("/map/foyer/assets/mat2.png"),0,0,32,34);t.addStaticSprite(l,"2f_mat",t.getWidth()-(l.getSpriteFrameDimensions().w-10),20);const d=new X(16119260,0,0,278,60);d.modifyCollisionBoundary(null,-15,null,-20),t.addBottomEdgeDetour(d,[{x:190,y:220},{x:60,y:220},{x:60,y:30}]),t.addBottomEdgeDetour(d,[{x:310,y:220},{x:455,y:220},{x:455,y:30}]),t.addLeftEdgeDetour(d,[{x:80,y:30},{x:260,y:30},{x:440,y:30},{x:440,y:200}]),t.addLeftEdgeDetour(d,[{x:60,y:170}]),t.addRightEdgeDetour(d,[{x:425,y:30},{x:260,y:30},{x:60,y:30},{x:60,y:200}]),t.addRightEdgeDetour(d,[{x:460,y:170}]),t.addTopEdgeDetour(d,[{x:180,y:30},{x:60,y:30},{x:60,y:200}]),t.addTopEdgeDetour(d,[{x:330,y:30},{x:440,y:30},{x:440,y:200}]),t.addStaticSprite(d,"wall",117,80);const c=new R(it("/map/foyer/assets/stairs.png"),0,0,117,95);t.addStaticSprite(c,"stairs1",0,d.getLeftPosY()+15);const g=new R(it("/map/foyer/assets/stairs.png"),0,0,117,95);t.addStaticSprite(g,"stairs2",t.getWidth()-g.getSpriteFrameDimensions().w,c.getLeftPosY());const u=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(u,"railing1",c.getRightPosX()+4,d.getLeftPosY()+15-5-(u.getSpriteFrameDimensions().h-5));const p=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(p,"railing2",u.getRightPosX(),u.getLeftPosY());const m=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(m,"railing3",p.getRightPosX(),p.getLeftPosY());const f=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(f,"railing4",m.getRightPosX(),m.getLeftPosY());const w=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(w,"railing5",f.getRightPosX(),f.getLeftPosY());const y=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(y,"railing6",w.getRightPosX(),w.getLeftPosY());const S=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(S,"railing7",y.getRightPosX(),y.getLeftPosY());const _=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(_,"railing8",S.getRightPosX(),S.getLeftPosY());const P=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(P,"railing9",_.getRightPosX(),_.getLeftPosY());const v=new R(it("/map/foyer/assets/railing.png"),0,0,27,18);t.addStaticSprite(v,"railing10",P.getRightPosX(),P.getLeftPosY());const b=new R(it("/map/foyer/assets/mat.png"),0,0,48,96);t.addStaticSprite(b,"1f_mat",t.getHalfWidth()-(b.getSpriteFrameDimensions().w-6),t.getHeight()-(b.getSpriteFrameDimensions().h+15));const x=new T(it("/map/foyer/assets/plantA.png"),0,0,48,96);x.modifyCollisionBoundary(null,50,null,null),t.addDynamicSprite(x,"plant1",0,t.getHeight()-(x.getSpriteFrameDimensions().h+5));const I=new T(it("/map/foyer/assets/plantA.png"),0,0,48,96);I.modifyCollisionBoundary(null,50,null,null),t.addDynamicSprite(I,"plant2",t.getWidth()-I.getSpriteFrameDimensions().w,t.getHeight()-(I.getSpriteFrameDimensions().h+5));const E=new J(st("/consumables/ammoCache.png"),240,140,50,50);return t.addStaticSprite(E,"ammo_cache1",240,120),t}(),ot=function(){const t=new et(512,256);t.addEnemySpawnPoint(t.getHalfWidth()+130,50),t.addEnemySpawnPoint(t.getHalfWidth(),t.getHeight()-30);const e=new R(it("/map/library/assets/libraryfloor.png"),0,0,512,256);t.addStaticSprite(e,"libraryfloor",0,0);const i=new X(0,0,0,t.getWidth(),10);i.modifyCollisionBoundary(null,null,null,-i.getHalfHeight()),t.addStaticSprite(i,"barrier1",0,-i.getFillDimensions().h);const s=new X(0,0,0,t.getWidth(),10);t.addStaticSprite(s,"barrier2",0,t.getHeight());const n=new X(0,0,0,10,t.getHeight());n.modifyCollisionBoundary(null,null,-3,null),t.addStaticSprite(n,"barrier3",-n.getFillDimensions().w,0);const o=new X(0,0,0,10,t.getHeight());o.modifyCollisionBoundary(-3,null,null,null),t.addStaticSprite(o,"barrier4",t.getWidth(),0);const r=new Z(t,it("/map/library/assets/mat2.png"),0,0,32,34);t.addStaticSprite(r,"2f_mat",t.getWidth()-(r.getSpriteFrameDimensions().w+495),20);const a=new T(it("/map/library/assets/bookshelf.png"),0,0,95,97);a.modifyCollisionBoundary(null,a.getSpriteFrameDimensions().h-30,null,null),t.addDynamicSprite(a,"bookshelf1",t.getWidth()-a.getSpriteFrameDimensions().w,t.getHeight()-(a.getSpriteFrameDimensions().h+50));const h=new T(it("/map/library/assets/bookshelf.png"),0,0,95,97);h.modifyCollisionBoundary(null,h.getSpriteFrameDimensions().h-30,null,null),t.addDynamicSprite(h,"bookshelf2",t.getWidth()-h.getSpriteFrameDimensions().w,0);const l=new T(it("/map/library/assets/chairA.png"),0,0,75,48);t.addStaticSprite(l,"chairA",20,t.getHeight()-(l.getSpriteFrameDimensions().h+15));const d=new T(it("/map/library/assets/chairB.png"),0,0,48,75);d.modifyCollisionBoundary(null,40,null,null),t.addDynamicSprite(d,"chairB",130,t.getHeight()-(d.getSpriteFrameDimensions().h+75));const c=new R(it("/map/library/assets/matBlue.png"),0,0,71,54);t.addStaticSprite(c,"matblue",120,t.getHeight()-(c.getSpriteFrameDimensions().h+12));const g=new T(it("/map/library/assets/tableLamp.png"),0,0,95,66);g.modifyCollisionBoundary(null,30,null,null),t.addDynamicSprite(g,"tablelamp",10,t.getHeight()-(g.getSpriteFrameDimensions().h+80));const u=new R(it("/map/library/assets/window.png"),0,0,525,75);return t.addStaticSprite(u,"window",-6,-(u.getSpriteFrameDimensions().h-5)),t}(),rt=function(){const t=new et(555,441);t.addEnemySpawnPoint(50,50),t.addEnemySpawnPoint(50,t.getHeight()-150),t.addEnemySpawnPoint(280,t.getHeight()-30);const e=new R(it("/map/basement/assets/basefloor.png"),0,0,555,441);t.addStaticSprite(e,"floor",0,0);const i=new X(0,0,0,t.getWidth(),10);i.modifyCollisionBoundary(null,null,null,-i.getHalfHeight()),t.addStaticSprite(i,"barrier1",0,-i.getFillDimensions().h);const s=new X(0,0,0,t.getWidth(),10);t.addStaticSprite(s,"barrier2",0,t.getHeight());const n=new X(0,0,0,10,t.getHeight());n.modifyCollisionBoundary(null,null,-3,null),t.addStaticSprite(n,"barrier3",-n.getFillDimensions().w,0);const o=new X(0,0,0,10,t.getHeight());o.modifyCollisionBoundary(-3,null,null,null),t.addStaticSprite(o,"barrier4",t.getWidth(),0);const r=new T(it("/map/basement/assets/baseelevator.png"),0,0,96,48);t.addStaticSprite(r,"double_door",t.getHalfWidth()-r.getHalfWidth(),-(r.getSpriteFrameDimensions().h+1));const a=new tt(t,16711680,0,0,r.getSpriteFrameDimensions().w,35);a.setAlpha(0),t.addStaticSprite(a,"elevator",r.getLeftPosX(),r.getRightPosY());const h=new T(it("/map/basement/assets/basecouch.png"),0,0,143,165);h.modifyCollisionBoundary(null,10,null,null),t.addStaticSprite(h,"basecouch",t.getHalfWidth()+h.getHalfWidth(),t.getHeight()-(h.getSpriteFrameDimensions().h+90));const l=new T(it("/map/basement/assets/fireplace.png"),0,0,94,116);l.modifyCollisionBoundary(null,30,null,-10),t.addStaticSprite(l,"fireplace",t.getHalfWidth()+h.getHalfWidth(),t.getHeight()-(h.getSpriteFrameDimensions().h+250));const d=new T(it("/map/basement/assets/brokencupboard.png"),0,0,80,108);t.addStaticSprite(d,"brokencupboard",t.getWidth()-(d.getSpriteFrameDimensions().w+450),t.getHeight()-(d.getSpriteFrameDimensions().h+5));const c=new T(it("/map/basement/assets/stackedcupboard.png"),0,0,48,107);t.addStaticSprite(c,"stackedcupboard",t.getWidth()-(c.getSpriteFrameDimensions().w+400),t.getHeight()-(c.getSpriteFrameDimensions().h+5));const g=new T(it("/map/basement/assets/openchest.png"),0,0,59,63);t.addStaticSprite(g,"openchest",t.getWidth()-(g.getSpriteFrameDimensions().w+340),t.getHeight()-(g.getSpriteFrameDimensions().h+5));const u=new Q(st("/consumables/upgradeBench.png"),240,140,50,50);return t.addStaticSprite(u,"upgrade_bench1",240,120),t}();class at{constructor(t,e,n,o,r){s(t,W),s(e,PIXI.Texture),i(n),i(o),s(r,PIXI.Texture),this.sprite=new PIXI.Sprite(e),this.inventory=[null,null,null,null,null,null,null,null],this.currentSelItem=null,this.inventoryContainer=new PIXI.Container,this.inventoryContainer.x=n,this.inventoryContainer.y=o,this.selectorSprite=new PIXI.Sprite(r),this.selectorSprite.x=-2,this.selectorSprite.y=-2,this.selectorSprite.width=36,this.selectorSprite.height=36,this.inventoryContainer.addChild(this.sprite,this.selectorSprite),this.player=t}___getPositionInInventory__(t){return i(t),(this.selectorSprite.width-4)*(t-1)-2}display(){return this.inventoryContainer}getSelItem(){return this.currentSelItem}addItem(t){s(t,l);const e=t.getIcon();this.inventoryContainer.addChild(e);const i=this.inventory.length;let n=!1;for(let s=0;s<i;s++)if(null===this.inventory[s]){this.inventory.splice(s,1,t),e.x=this.___getPositionInInventory__(s+1)+2,n=!0;break}}changeSelItem(t){this.player.unequip();const e=this.inventory[t-1];this.currentSelItem=e,e instanceof l?(this.player.equip(e),e instanceof w?I(e):E()):E(),this.selectorSprite.x=this.___getPositionInInventory__(t)}removeSelItem(){const t=this.currentSelItem.getIcon(),e=this.inventoryContainer.getChildIndex(t)-2;this.inventoryContainer.removeChild(t),this.inventory.splice(e,1,null),this.currentSelItem=null}}var ht;ht=JSON.parse('{"el":{"x":0,"y":0,"w":30,"h":46},"er":{"x":33,"y":1,"w":29,"h":46},"e":{"x":64,"y":1,"w":29,"h":47},"nl":{"x":95,"y":1,"w":30,"h":46},"nr":{"x":127,"y":1,"w":30,"h":46},"n":{"x":159,"y":1,"w":29,"h":47},"sl":{"x":190,"y":1,"w":30,"h":46},"sr":{"x":222,"y":1,"w":30,"h":46},"s":{"x":254,"y":1,"w":29,"h":46},"wl":{"x":285,"y":1,"w":29,"h":46},"w":{"x":316,"y":1,"w":29,"h":47},"wr":{"x":347,"y":1,"w":29,"h":46}}');class lt{constructor(t,e,i){r(e),this.id=t,this.batches=e,this.difficultyMod=i,this.currentBatch=0,this.toSpawnNext=[]}getNextBatch(){if(this.toSpawnNext=[],this.currentBatch>=this.batches.length)return 0;for(let e=0;e<this.batches[this.currentBatch];e++){const e=new N(st("/sprite_sheets/enemies/clothed_zombie.png"),0,0,t(ht).s.w,t(ht).s.h);this.toSpawnNext.push(e)}return this.currentBatch++,this.toSpawnNext}}class dt{constructor(t,e,n){if(s(t,et),r(e),0===e.length)throw Error("Waves cannot be empty.");e.every((t=>{if(t instanceof lt==!1)throw TypeError("All waves must be an instance of the Wave class.")})),i(n),this.map=t,this.spawnPoints=t.getEnemySpawnPoints(),this.current_wave_index=0,this.waves=e,this.current_wave=this.waves[0],this.next_wave_timeout=null,this.next_wave_delay=3e3,this.batch_delay=n,this.isBatchDone=!1,this.time=0,this.music=new Audio(`${u}/sounds/haunted-harpsichord.mp3`),this.music.volume=.1}getRandomInt(t,e){return i(t),i(e),t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}checkIfBatchDone(){return this.isBatchDone=Math.floor(Date.now()/1e3)-this.time>=this.batch_delay,this.isBatchDone}setWaveDelay(t){i(t),this.next_wave_delay=t}updatePlayableArea(t){s(t,et),this.map=t,this.spawnPoints=t.getEnemySpawnPoints()}moveToNextWaveIfFinished(){null===this.next_wave_timeout&&0===k.length&&this.current_wave_index+1<this.waves.length&&(this.waves.splice(this.waves.indexOf(this.current_wave),1,null),this.next_wave_timeout=setTimeout((()=>{this.current_wave_index++,this.current_wave=this.waves[this.current_wave_index],this.next_wave_timeout=null}),this.next_wave_delay))}spawnNextBatch(){let e=this.current_wave.getNextBatch();for(let i=0;i<e.length;i++){const s=e[i],n=s.getSpriteFrameDimensions();s.addFrames(t(ht)),s.switchFrame("n");const o=this.spawnPoints[this.getRandomInt(0,this.spawnPoints.length-1)];this.map.addDynamicSprite(s,(Date.now()*(i+1)).toString(),o.x-n.w,o.y-n.h),s.sprite.alpha=0,this.time=Math.floor(Date.now()/1e3)}}respawnBatch(){const t=k.length;if(t>0)for(let e=0;e<t;e++){const t=k[e],i=t.getSpriteFrameDimensions(),s=this.spawnPoints[this.getRandomInt(0,this.spawnPoints.length-1)];this.map.addDynamicSprite(t,`zombie${e}`,s.x-i.w,s.y-i.h),t.sprite.alpha=0,this.time=Math.floor(Date.now()/1e3)}}enemySpawnFadeIn(){const t=k.length;if(t>0)for(let e=0;e<t;e++){const t=k[e].sprite;t.alpha<1&&(t.alpha+=.01)}}playMusic(){this.music.paused&&this.music.play()}}const ct=document.getElementById("pause");function gt(){window.GAME_PAUSED=!1,ct.classList.add("hide")}ct.addEventListener("click",(t=>{const e=t.target;if("BUTTON"===e.tagName){const t=e.getAttribute("data-action");"resume"===t?gt():"exit"===t&&window.location.assign("/")}}));class ut extends l{constructor(t){super(t)}heal(t){s(t,W),t.increaseHealth(this.health)}}class pt extends ut{constructor(){super(st("/consumables/bandage_box.png")),this.health=20}}const mt={w:!1,s:!1,a:!1,d:!1};function ft(t){if(s(t,W),mt.s&&mt.d){const e=q(t).status,i=$(t).status;!1===e&&!1===i?t.moveSpriteSouthEast():e&&!1===i?t.moveSpriteEast():i&&!1===e&&t.moveSpriteSouth()}else if(mt.s&&mt.a){const e=q(t).status,i=G(t).status;!1===e&&!1===i?t.moveSpriteSouthWest():e&&!1===i?t.moveSpriteWest():i&&!1===e&&t.moveSpriteSouth()}else if(mt.w&&mt.d){const e=z(t).status,i=$(t).status;!1===e&&!1===i?t.moveSpriteNorthEast():e&&!1===i?t.moveSpriteEast():i&&!1===e&&t.moveSpriteNorth()}else if(mt.w&&mt.a){const e=z(t).status,i=G(t).status;!1===e&&!1===i?t.moveSpriteNorthWest():e&&!1===i?t.moveSpriteWest():i&&!1===e&&t.moveSpriteNorth()}else mt.w&&!1===z(t).status?t.moveSpriteNorth():mt.s&&!1===q(t).status?t.moveSpriteSouth():mt.a&&!1===G(t).status?t.moveSpriteWest():mt.d&&!1===$(t).status&&t.moveSpriteEast()}var wt;wt=JSON.parse('{"e":{"x":0,"y":0,"w":23,"h":32},"el":{"x":23,"y":0,"w":23,"h":31},"er":{"x":46,"y":0,"w":23,"h":31},"n":{"x":69,"y":0,"w":23,"h":32},"nl":{"x":92,"y":0,"w":23,"h":31},"nr":{"x":115,"y":0,"w":23,"h":31},"s":{"x":138,"y":0,"w":23,"h":33},"sl":{"x":161,"y":0,"w":23,"h":31},"sr":{"x":184,"y":0,"w":23,"h":31},"w":{"x":207,"y":0,"w":23,"h":32},"wl":{"x":230,"y":0,"w":23,"h":31},"wr":{"x":253,"y":0,"w":23,"h":31}}');const yt={fontSize:20,fill:16777215},St=new PIXI.Text("Press E to refill ammo.(500)",yt);St.alpha=0;const _t=new PIXI.Text("Press Q to change rooms.",yt);_t.alpha=0;const Pt=new PIXI.Text("CHOOSE UPGRADE(1000): E: Ammo and clip size. T: Damage",yt);function vt(t,e,i){i?t.alpha<1&&(t.alpha+=.01):t.alpha>0&&(t.alpha-=.01)}Pt.alpha=0,St.anchor.set(.5),St.x=window.innerWidth/2,St.y=20,_t.anchor.set(.5),_t.x=window.innerWidth/2,_t.y=20,Pt.anchor.set(.5),Pt.x=window.innerWidth/2,Pt.y=20,window.addEventListener("load",(()=>{const e=new PIXI.Application({resizeTo:window}),i=e.view;i.style.position="absolute",document.body.appendChild(i),window.timeGameStarted=new Date,window.GAME_PAUSED=!1,window.playableAreaExists=!1,window.HOTBAR=void 0;const s=new dt(nt,[new lt(0,[1],1)],5),n=new W(st("/sprite_sheets/player/player.png"),0,0,t(wt).s.w,t(wt).s.h);n.addFrames(t(wt)),n.switchFrame("e"),window.HOTBAR=new at(n,st("/inventory/hotbar.png"),20,50,st("/inventory/selector.png"));const o=new y(st("/guns/handgun.png"));window.HOTBAR.addItem(o),window.HOTBAR.addItem(new pt),window.HOTBAR.changeSelItem(8),window.addEventListener("keyup",(t=>{switch(t.key.toLowerCase()){case"w":mt.w=!1;break;case"s":mt.s=!1;break;case"a":mt.a=!1;break;case"d":mt.d=!1}})),window.addEventListener("keydown",(t=>{const e=t.key.toLowerCase();if("escape"===e&&!0===window.playableAreaExists&&(!1===window.GAME_PAUSED?(window.GAME_PAUSED=!0,ct.classList.remove("hide")):window.GAME_PAUSED&&gt()),!1===window.GAME_PAUSED){const t=window.HOTBAR.getSelItem();switch(e){case"w":mt.w=!0;break;case"s":mt.s=!0;break;case"a":mt.a=!0;break;case"d":mt.d=!0;break;case"1":window.HOTBAR.changeSelItem(1);break;case"2":window.HOTBAR.changeSelItem(2);break;case"3":window.HOTBAR.changeSelItem(3);break;case"4":window.HOTBAR.changeSelItem(4);break;case"5":window.HOTBAR.changeSelItem(5);break;case"6":window.HOTBAR.changeSelItem(6);break;case"7":window.HOTBAR.changeSelItem(7);break;case"8":window.HOTBAR.changeSelItem(8);break;case"r":t instanceof w&&t.getAmmoLoaded()!==t.getClipCapacity()&&t.getAmmoLeft()>0&&t.reload();break;case" ":t instanceof ut&&n.getHealth()<100&&(t.heal(n),window.HOTBAR.removeSelItem());break;case"q":const e=K.length;if(e>0)for(let t=0;t<e;t++){const e=K[t];if(e.playerIsInsidePortal(n)){e.teleport(n),s.updatePlayableArea(e.destination),s.respawnBatch();break}}break;case"t":for(let t=0;t<U.length;t++){const e=U[t];e.playerIsNearInteractable(n,Pt)&&e instanceof Q&&n.currentPoints>=e.pointCost&&window.HOTBAR.getSelItem()instanceof w&&(n.currentPoints-=e.pointCost,b(n.currentPoints),e.upgradeGun(window.HOTBAR.getSelItem(),!1))}case"e":const i=U.length;for(let t=0;t<i;t++){const e=U[t];e.playerIsNearInteractable(n,St)&&e instanceof J&&n.currentPoints>=e.pointCost&&window.HOTBAR.getSelItem()instanceof w&&(n.currentPoints-=e.pointCost,b(n.currentPoints),e.resupply(window.HOTBAR.getSelItem())),e.playerIsNearInteractable(n,Pt)&&e instanceof Q&&n.currentPoints>=e.pointCost&&window.HOTBAR.getSelItem()instanceof w&&(n.currentPoints-=e.pointCost,b(n.currentPoints),e.upgradeGun(window.HOTBAR.getSelItem(),!0))}}ft(n);const i=k.length;if(i>0)for(let t=0;t<i;t++)k[t].rotateToPlayer(n)}})),window.addEventListener("mousemove",(t=>{window.mouseX=t.x,window.mouseY=t.y,!1===window.GAME_PAUSED&&!1===mt.w&&!1===mt.a&&!1===mt.s&&!1===mt.d&&n.rotateToMouse()})),window.addEventListener("contextmenu",(t=>{t.preventDefault()})),nt.addDynamicSprite(n,"player",250,150),nt.setPosition(.5*i.width-nt.getHalfWidth(),.5*i.height-nt.getHalfHeight()),nt.bindPlayableAreaToPortal("2f_mat",ot,5,15),nt.bindPlayableAreaToPortal("elevator",rt,rt.getHalfWidth()-10,0),ot.setPosition(.5*i.width-ot.getHalfWidth(),.5*i.height-ot.getHalfHeight()),ot.bindPlayableAreaToPortal("2f_mat",nt,480,12),rt.setPosition(.5*i.width-rt.getHalfWidth(),.5*i.height-rt.getHalfHeight()),rt.bindPlayableAreaToPortal("elevator",nt,245,0),e.stage.addChild(_,x,v,Pt,St,_t,window.HOTBAR.display(),nt.load()),e.ticker.add((()=>{if(!1===window.GAME_PAUSED){s.enemySpawnFadeIn(),s.checkIfBatchDone()&&(s.spawnNextBatch(),s.moveToNextWaveIfFinished());let e=!1;const i=[St,Pt];var t;for(let s=0;s<U.length;s++)e=(t=U[s]).playerIsNearInteractable(n),t instanceof J?vt(i[0],0,e):t instanceof Q&&vt(i[1],0,e);const o=K.length;e=!1;for(let t=0;t<o;t++){e=e||K[t].playerIsInsidePortal(n)}if(vt(_t,0,e),k.length>0)for(let t=0;t<k.length;t++)k[t].removeSelf()&&(n.currentPoints+=100,b(n.currentPoints))}}))}))})();
//# sourceMappingURL=test.js.map
